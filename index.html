<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Website Pribadi â€” Versi Lengkap</title>

  <!-- Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css" />
  <meta name="description" content="Website pribadi modern dengan video background, animasi, mode gelap/terang, edit mode, dan galeri upload/delete admin.">
</head>
<body class="theme-auto">
  <!-- PRELOADER -->
  <div id="preloader" class="preloader" aria-hidden="true">
    <div class="loader-wrap">
      <div class="logo" id="preloaderLogo">AS</div>
      <div class="spinner"></div>
      <div class="loading-text">Memuat pengalamanâ€¦</div>
    </div>
  </div>

  <!-- SCROLL PROGRESS BAR -->
  <div id="scroll-progress" class="scroll-progress"><span></span></div>

  <!-- VIDEO BACKGROUND -->
  <video id="bg-video" class="bg-video" autoplay muted playsinline loop>
    <source src="bg.mp4" type="video/mp4">
  </video>

  <!-- Lapisan gradient & glow -->
  <div class="bg"></div>

  <!-- Kanvas partikel lembut -->
  <canvas id="particles" class="particles"></canvas>

  <!-- Kanvas confetti -->
  <canvas id="confetti" class="confetti"></canvas>

  <!-- TOPBAR: Theme Toggle + Admin -->
  <div class="topbar">
    <button id="themeToggle" class="top-btn" title="Ganti tema">ðŸŒ“</button>
    <button id="adminToggle" class="top-btn" title="Mode Admin">ðŸ”’</button>
  </div>

  <!-- Admin Panel -->
  <aside id="adminPanel" class="admin-panel" aria-hidden="true">
    <div class="panel-row">
      <strong>Mode Admin</strong>
      <div class="spacer"></div>
      <button id="exitAdmin" class="chip">Keluar</button>
    </div>
    <div class="panel-row">
      <label class="lbl">Inisial Logo Preloader</label>
      <input id="logoInitial" class="inp" maxlength="4" placeholder="AS" />
      <button id="saveLogo" class="chip">Simpan</button>
    </div>
    <div class="panel-row">
      <label class="lbl">Nama Lengkap</label>
      <input id="nameInput" class="inp" placeholder="Nama Lengkap Kamu" />
      <button id="saveName" class="chip">Simpan</button>
    </div>
    <div class="panel-row">
      <label class="lbl">Headline (ketik)</label>
      <input id="typingWords" class="inp" placeholder="Pisahkan dengan koma" />
      <button id="saveTyping" class="chip">Simpan</button>
    </div>
    <div class="panel-row">
      <button id="toggleEditables" class="chip">Aktifkan Edit Teks</button>
      <button id="saveEditables" class="chip">Simpan Teks</button>
      <button id="resetAll" class="chip danger">Reset Data</button>
    </div>
  </aside>

  <main class="container">
    <header class="hero parallax" data-speed="0.15">
      <img class="avatar float-in" src="https://via.placeholder.com/240x240.png?text=Foto+Profil" alt="Foto Profil">
      <h1 id="displayName" class="title glow-text" data-editable>Nama Lengkap Kamu</h1>
      <p class="subtitle">
        <span id="typing"></span>
        <span class="caret" aria-hidden="true"></span>
      </p>

      <!-- Badge berlari (marquee halus) -->
      <div class="ticker" aria-hidden="true">
        <div class="track">
          <span>ðŸŽ¯ Siap Kolaborasi</span>
          <span>âš¡ Web â€¢ Desain â€¢ Konten</span>
          <span>ðŸ’¼ Available for Project</span>
          <span>ðŸ“© DM via WhatsApp / IG</span>
        </div>
      </div>
    </header>

    <section class="card info reveal" data-anim="fade-up">
      <h2 data-editable>Informasi Pribadi</h2>
      <div class="grid">
        <div class="row"><span data-editable>Nama</span><b id="infoNama" data-editable>Nama Lengkap Kamu</b></div>
        <div class="row"><span data-editable>Tempat & Tanggal Lahir</span><b id="infoTTL" data-editable>Kota, 01 Januari 2000</b></div>
        <div class="row"><span data-editable>Alamat</span><b id="infoAlamat" data-editable>Jl. Contoh No. 123, Kota</b></div>
        <div class="row"><span data-editable>Status</span><b id="infoStatus" data-editable>Pelajar / Mahasiswa / Bekerja</b></div>
      </div>
    </section>

    <section class="card edu reveal parallax" data-speed="0.08" data-anim="slide-left">
      <h2 data-editable>Pendidikan</h2>
      <ul id="timeline" class="timeline">
        <li>
          <div class="dot"></div>
          <div class="content">
            <h3 data-editable>S1 Teknik Informatika â€” Universitas Contoh</h3>
            <p data-editable>2021 â€“ Sekarang</p>
          </div>
        </li>
        <li>
          <div class="dot"></div>
          <div class="content">
            <h3 data-editable>SMA Negeri 1 Contoh</h3>
            <p data-editable>2018 â€“ 2021</p>
          </div>
        </li>
      </ul>
    </section>

    <section id="gallery" class="card gallery reveal" data-anim="fade-up">
      <div class="gallery-head">
        <h2>Album Foto</h2>
        <div class="gh-actions">
          <input id="fileInput" class="file" type="file" accept="image/*" multiple hidden>
          <button id="btnUpload" class="chip" title="Unggah foto">Upload</button>
        </div>
      </div>
      <div id="dropzone" class="dropzone">
        <p>Tarik & letakkan gambar di sini atau klik tombol Upload di atas.</p>
        <small>Format: JPG/PNG/WebP. Disimpan di perangkat (localStorage).</small>
      </div>
      <div id="galleryGrid" class="gallery-grid"></div>
    </section>

    <section id="social" class="card social reveal" data-anim="slide-right">
      <h2 data-editable>Sosial Media</h2>
      <div class="icons">
        <a class="btn shimmer ripple" href="https://wa.me/628123456789" target="_blank" rel="noopener" aria-label="WhatsApp">
          <svg viewBox="0 0 32 32" aria-hidden="true"><path d="M19.11 17.52c-.28-.14-1.64-.81-1.89-.9-.25-.09-.43-.14-.61.14-.18.28-.7.9-.86 1.08-.16.18-.32.2-.6.07-.28-.14-1.17-.43-2.23-1.38-.82-.73-1.38-1.64-1.54-1.92-.16-.28-.02-.43.12-.56.12-.12.28-.32.4-.49.14-.16.18-.28.28-.46.09-.18.05-.34-.02-.49-.07-.14-.61-1.48-.84-2.03-.22-.53-.45-.46-.61-.46h-.52c-.18 0-.46.07-.7.34-.25.28-.95.93-.95 2.27s.97 2.63 1.1 2.81c.14.18 1.92 2.93 4.65 4.11.65.28 1.16.45 1.56.58.65.21 1.24.18 1.7.11.52-.08 1.64-.67 1.87-1.32.23-.65.23-1.2.16-1.32-.07-.12-.25-.2-.53-.34z"/><path d="M27.5 4.5C24.6 1.6 20.6 0 16.4 0 7.4 0 0 7.4 0 16.4c0 2.9.8 5.7 2.4 8.1L0 32l7.7-2.3c2.3 1.2 4.9 1.9 7.6 1.9 9 0 16.4-7.4 16.4-16.4 0-4.2-1.6-8.2-4.7-10.7zM16.4 29.1c-2.5 0-4.9-.7-7-2l-.5-.3-4.6 1.4 1.4-4.5-.3-.5c-1.3-2.2-2-4.7-2-7.2C3.3 8.5 9.2 2.6 16.4 2.6c3.6 0 7 1.4 9.5 3.9s3.9 5.9 3.9 9.5c0 7.2-5.9 13.1-13.1 13.1z"/></svg>
          WhatsApp
          <span class="ripple-ink"></span>
        </a>
        <a class="btn shimmer ripple" href="https://instagram.com/username" target="_blank" rel="noopener" aria-label="Instagram">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2.2c3.2 0 3.6 0 4.8.1 1.2.1 1.9.3 2.4.5.6.2 1 .5 1.5 1 .5.4.8.9 1 1.5.2.5.4 1.2.5 2.4.1 1.2.1 1.6.1 4.8s0 3.6-.1 4.8c-.1 1.2-.3 1.9-.5 2.4-.2.6-.5 1-1 1.5-.4.5-.9.8-1.5 1-.5.2-1.2.4-2.4.5-1.2.1-1.6.1-4.8.1s-3.6 0-4.8-.1c-1.2-.1-1.9-.3-2.4-.5-.6-.2-1-.5-1.5-1-.5-.4-.8-.9-1-1.5-.2-.5-.4-1.2-.5-2.4C2.2 15.6 2.2 15.2 2.2 12s0-3.6.1-4.8c.1-1.2.3-1.9.5-2.4.2-.6.5-1 1-1.5.4-.5.9-.8 1.5-1 .5-.2 1.2-.4 2.4-.5C8.4 2.2 8.8 2.2 12 2.2m0-2.2C8.7 0 8.3 0 7 0S4.1.1 3 .3c-1.1.2-2 .6-2.8 1.4C-.6 2.6-.9 3.5-.3 6.4.2 9.2.2 10.7.2 12s0 2.8.1 5.6c.1 2.9.3 3.8 1.1 4.6.8.8 1.7 1.1 4.6 1.1S8.7 24 12 24s3.3 0 6.1-.1c2.9-.1 3.8-.3 4.6-1.1.8-.8 1.1-1.7 1.1-4.6S24 14.8 24 12s0-2.8-.1-5.6c-.1-2.9-.3-3.8-1.1-4.6C22 1 21.1.7 18.2.6 15.3.6 13.8.6 12 .6z"/><circle cx="18.4" cy="5.6" r="1.4"/><path d="M12 5.9A6.1 6.1 0 1 0 18.1 12 6.1 6.1 0 0 0 12 5.9zm0 10.1A4 4 0 1 1 16 12a4 4 0 0 1-4 4z"/></svg>
          Instagram
          <span class="ripple-ink"></span>
        </a>
        <a class="btn shimmer ripple" href="https://t.me/username" target="_blank" rel="noopener" aria-label="Telegram">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M9.036 15.28 8.88 18.5c.36 0 .52-.16.72-.36l1.728-1.656 3.588 2.64c.66.36 1.128.18 1.308-.6l2.376-11.16c.24-1.14-.432-1.584-1.08-1.308L3.78 10.2c-1.104.432-1.092 1.056-.192 1.332l3.78 1.176 8.772-5.532c.408-.264.78-.12.474.144"/></svg>
          Telegram
          <span class="ripple-ink"></span>
        </a>
      </div>
    </section>

    <footer class="foot reveal" data-anim="zoom-in">
      <audio id="bgm" preload="auto" loop>
        <source src="backsound.mp3" type="audio/mpeg">
        <source src="backsound.wav" type="audio/wav">
        Browser Anda tidak mendukung pemutaran audio.
      </audio>
      <p>Â© <span id="year"></span> <span id="footerName" data-editable>Nama Lengkap Kamu</span></p>
    </footer>
  </main>

  <!-- Toast kecil untuk info unmute sekali sentuh -->
  <div id="toast" class="toast" role="status" aria-live="polite">
    Sentuh sekali untuk mengaktifkan backsound ðŸŽµ
  </div>

  <script>
    // ====== Konfigurasi dasar ======
    const ADMIN_PASSWORD = 'admin123'; // GANTI ini
    const LS_KEYS = {
      theme: 'site_theme',
      name: 'display_name',
      logo: 'preloader_logo',
      typing: 'typing_words',
      editables: 'editable_texts',
      gallery: 'gallery_items'
    };

    // Tahun
    document.getElementById('year').textContent = new Date().getFullYear();

    // ===== THEME TOGGLE =====
    const themeBtn = document.getElementById('themeToggle');
    function applyTheme(mode){
      document.body.classList.remove('theme-dark','theme-light','theme-auto');
      document.body.classList.add(mode);
      localStorage.setItem(LS_KEYS.theme, mode);
    }
    themeBtn.addEventListener('click', ()=>{
      const current = localStorage.getItem(LS_KEYS.theme) || 'theme-auto';
      const next = current==='theme-auto' ? 'theme-dark' : current==='theme-dark' ? 'theme-light' : 'theme-auto';
      applyTheme(next);
    });
    applyTheme(localStorage.getItem(LS_KEYS.theme) || 'theme-auto');

    // ===== PRELOADER =====
    const preLogo = document.getElementById('preloaderLogo');
    const savedLogo = localStorage.getItem(LS_KEYS.logo);
    if(savedLogo) preLogo.textContent = savedLogo;

    window.addEventListener('load', () => {
      const pre = document.getElementById('preloader');
      pre.classList.add('done');
      setTimeout(()=>pre.remove(), 800);
    });

    // ===== SCROLL PROGRESS BAR =====
    const prog = document.querySelector('#scroll-progress span');
    const onScrollProg = () => {
      const h = document.documentElement;
      const scrolled = (h.scrollTop) / (h.scrollHeight - h.clientHeight) * 100;
      prog.style.width = scrolled + '%';
    };
    document.addEventListener('scroll', onScrollProg, {passive:true});
    onScrollProg();

    // ===== Reveal on scroll + variasi animasi =====
    const io = new IntersectionObserver((entries)=> {
      entries.forEach(e=>{
        if(e.isIntersecting){
          const anim = e.target.dataset.anim || 'fade-up';
          e.target.classList.add('in', anim);
          io.unobserve(e.target);
        }
      });
    }, {threshold: 0.15});
    document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

    // ===== Parallax halus =====
    const parallaxEls = [...document.querySelectorAll('.parallax')];
    window.addEventListener('scroll', ()=>{
      const y = window.scrollY;
      parallaxEls.forEach(el=>{
        const speed = parseFloat(el.dataset.speed || 0.1);
        el.style.transform = `translate3d(0, ${y*speed}px, 0)`;
      });
    }, {passive:true});

    // ===== Partikel lembut =====
    (function(){
      const c = document.getElementById('particles');
      const ctx = c.getContext('2d');
      let dpr = Math.max(1, window.devicePixelRatio||1);
      let W, H, dots;
      function resize(){
        W = c.clientWidth; H = c.clientHeight;
        c.width = W*dpr; c.height = H*dpr;
        ctx.setTransform(dpr,0,0,dpr,0,0);
        spawn();
      }
      function spawn(){
        const count = Math.round((W*H)/22000);
        dots = Array.from({length: count}, () => ({
          x: Math.random()*W,
          y: Math.random()*H,
          r: 1+Math.random()*2,
          a: 0.2+Math.random()*0.5,
          vx: -0.2+Math.random()*0.4,
          vy: -0.2+Math.random()*0.4
        }));
      }
      function tick(){
        ctx.clearRect(0,0,W,H);
        dots.forEach(p=>{
          p.x+=p.vx; p.y+=p.vy;
          if(p.x<0) p.x=W; if(p.x>W) p.x=0;
          if(p.y<0) p.y=H; if(p.y>H) p.y=0;
          ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
          ctx.fillStyle=`rgba(255,255,255,${p.a})`; ctx.fill();
        });
        requestAnimationFrame(tick);
      }
      window.addEventListener('resize', resize);
      resize(); tick();
    })();

    // ===== Typing effect =====
    const typingEl = document.getElementById('typing');
    const displayNameEl = document.getElementById('displayName');
    const footerNameEl = document.getElementById('footerName');
    const savedName = localStorage.getItem(LS_KEYS.name);
    if(savedName){ displayNameEl.textContent = savedName; footerNameEl.textContent = savedName; }
    let words = (localStorage.getItem(LS_KEYS.typing) || 'Web Developer,Desainer Konten,Siap Kolaborasi,Belajar Tanpa Henti')
                 .split(',').map(s=>s.trim()).filter(Boolean);
    let wi = 0, ci = 0, erasing = false;
    function typeTick(){
      const w = words[wi] || '';
      if(!erasing){
        typingEl.textContent = w.slice(0, ci++);
        if(ci > w.length){ erasing = true; setTimeout(typeTick, 1200); return; }
      } else {
        typingEl.textContent = w.slice(0, ci--);
        if(ci < 0){ erasing = false; wi = (wi+1)%words.length; }
      }
      setTimeout(typeTick, erasing ? 40 : 80);
    }
    typeTick();

    // ===== BACKSOUND autoplay (tanpa tombol) =====
const audio = document.getElementById('bgm');
const toast = document.getElementById('toast');

function rampVolume(target=0.6, step=0.05, interval=120){
  const iv = setInterval(()=>{
    audio.volume = Math.min(target, (audio.volume||0) + step);
    if(audio.volume >= target){ clearInterval(iv); }
  }, interval);
}

async function safePlay(startVol=0.0){
  try{
    audio.muted = false;
    audio.volume = startVol;
    // iOS sometimes needs a load() after user gesture
    if(audio.readyState < 2){ try{ audio.load(); }catch(e){} }
    await audio.play();
    console.log('[bgm] play() success');
    rampVolume(0.6, 0.05, 120);
    return true;
  }catch(err){
    console.warn('[bgm] play() blocked:', err && err.message);
    return false;
  }
}

// Try silent autoplay first (may be blocked by policy)
(async ()=>{
  const ok = await safePlay(0.0);
  if(ok){
    toast.classList.add('hide');
  }else{
    // Show hint and wait for any user gesture to unlock
    toast.classList.add('show');
    const unlock = async () => {
      const ok2 = await safePlay(0.0);
      if(ok2){
        toast.classList.add('hide');
        removeUnlockers();
      }
    };
    function removeUnlockers(){
      window.removeEventListener('pointerdown', unlock, {capture:true});
      window.removeEventListener('click', unlock, {capture:true});
      window.removeEventListener('touchstart', unlock, {capture:true});
      window.removeEventListener('keydown', unlock, {capture:true});
      document.removeEventListener('visibilitychange', onVisible, {capture:true});
    }
    function onVisible(){
      if(document.visibilityState === 'visible'){ unlock(); }
    }
    // Add multiple unlock paths
    window.addEventListener('pointerdown', unlock, {capture:true, once:true});
    window.addEventListener('click', unlock, {capture:true, once:true});
    window.addEventListener('touchstart', unlock, {capture:true, passive:true, once:true});
    window.addEventListener('keydown', unlock, {capture:true, once:true});
    document.addEventListener('visibilitychange', onVisible, {capture:true});
  }
})();
// ===== Ripple effect pada tombol =====
    document.querySelectorAll('.ripple').forEach(btn=>{
      btn.addEventListener('pointerdown', (e)=>{
        const rect = btn.getBoundingClientRect();
        const ink = btn.querySelector('.ripple-ink');
        const d = Math.max(rect.width, rect.height);
        ink.style.width = ink.style.height = d + 'px';
        const x = e.clientX - rect.left - d/2;
        const y = e.clientY - rect.top - d/2;
        ink.style.left = x + 'px';
        ink.style.top = y + 'px';
        ink.classList.remove('animate');
        void ink.offsetWidth;
        ink.classList.add('animate');
      });
    });

    // ===== Confetti saat Social section muncul =====
    ;(function(){
      const canvas = document.getElementById('confetti');
      const ctx = canvas.getContext('2d');
      let W, H, pieces = [];
      function resize(){
        W = canvas.clientWidth; H = canvas.clientHeight;
        canvas.width = W; canvas.height = H;
      }
      function burst(x=W/2, y=H*0.3, n=60){
        for(let i=0;i<n;i++){
          pieces.push({
            x, y,
            vx: (Math.random()-0.5)*6,
            vy: (Math.random()-1)*6,
            size: 4+Math.random()*6,
            rot: Math.random()*Math.PI,
            vr: (Math.random()-0.5)*0.2,
            life: 80+Math.random()*60,
            color: `hsl(${Math.floor(Math.random()*360)},85%,70%)`
          });
        }
      }
      function tick(){
        ctx.clearRect(0,0,W,H);
        pieces.forEach(p=>{
          p.vy += 0.12;
          p.x += p.vx; p.y += p.vy;
          p.rot += p.vr;
          p.life--;
          ctx.save();
          ctx.translate(p.x,p.y);
          ctx.rotate(p.rot);
          ctx.fillStyle = p.color;
          ctx.fillRect(-p.size/2,-p.size/2,p.size,p.size);
          ctx.restore();
        });
        pieces = pieces.filter(p=>p.life>0 && p.y < H+40);
        requestAnimationFrame(tick);
      }
      resize(); tick();
      window.addEventListener('resize', resize, {passive:true});
      const social = document.getElementById('social');
      const io2 = new IntersectionObserver((ents)=>{
        ents.forEach(ent=>{
          if(ent.isIntersecting){ burst(W*0.5, social.getBoundingClientRect().top + window.scrollY - 80, 100); io2.disconnect(); }
        });
      }, {threshold:0.4});
      io2.observe(social);
    })();

    // ===== ADMIN MODE =====
    const adminBtn = document.getElementById('adminToggle');
    const adminPanel = document.getElementById('adminPanel');
    const exitAdminBtn = document.getElementById('exitAdmin');
    const toggleEditablesBtn = document.getElementById('toggleEditables');
    const saveEditablesBtn = document.getElementById('saveEditables');
    const resetAllBtn = document.getElementById('resetAll');
    const nameInput = document.getElementById('nameInput');
    const saveNameBtn = document.getElementById('saveName');
    const logoInitial = document.getElementById('logoInitial');
    const saveLogoBtn = document.getElementById('saveLogo');
    const typingWordsInp = document.getElementById('typingWords');
    const saveTypingBtn = document.getElementById('saveTyping');

    let isAdmin = false;
    let editEnabled = false;

    function openAdmin(){
      adminPanel.classList.add('on');
      document.body.classList.add('admin-on');
      adminBtn.textContent = 'âœ…';
      isAdmin = true;
      updateGalleryAdminState();
    }
    function closeAdmin(){
      adminPanel.classList.remove('on');
      document.body.classList.remove('admin-on');
      adminBtn.textContent = 'ðŸ”’';
      isAdmin = false;
      disableEditables();
      updateGalleryAdminState();
    }

    adminBtn.addEventListener('click', ()=>{
      if(isAdmin){ closeAdmin(); return; }
      const pass = prompt('Masukkan password admin:');
      if(pass === ADMIN_PASSWORD){ openAdmin(); }
      else alert('Password salah.');
    });
    exitAdminBtn.addEventListener('click', closeAdmin);

    // Editables
    const editableEls = [...document.querySelectorAll('[data-editable]')];
    function enableEditables(){
      editableEls.forEach(el=>el.setAttribute('contenteditable', 'true'));
      toggleEditablesBtn.textContent = 'Matikan Edit Teks';
      editEnabled = true;
    }
    function disableEditables(){
      editableEls.forEach(el=>el.removeAttribute('contenteditable'));
      toggleEditablesBtn.textContent = 'Aktifkan Edit Teks';
      editEnabled = false;
    }
    toggleEditablesBtn.addEventListener('click', ()=>{
      (editEnabled ? disableEditables : enableEditables)();
    });
    saveEditablesBtn.addEventListener('click', ()=>{
      const data = {};
      editableEls.forEach((el,i)=>{ data[i] = el.innerHTML; });
      localStorage.setItem(LS_KEYS.editables, JSON.stringify(data));
      alert('Teks tersimpan.');
    });
    // Restore editables
    const savedEditables = localStorage.getItem(LS_KEYS.editables);
    if(savedEditables){
      const data = JSON.parse(savedEditables);
      editableEls.forEach((el,i)=>{ if(data[i]!==undefined) el.innerHTML = data[i]; });
    }

    // Save & restore name
    saveNameBtn.addEventListener('click', ()=>{
      const val = nameInput.value.trim();
      if(!val) return;
      localStorage.setItem(LS_KEYS.name, val);
      document.getElementById('displayName').textContent = val;
      document.getElementById('footerName').textContent = val;
      alert('Nama disimpan.');
    });
    if(savedName) nameInput.value = savedName;

    // Save & restore logo initial
    saveLogoBtn.addEventListener('click', ()=>{
      const val = logoInitial.value.trim().slice(0,4);
      if(!val) return;
      localStorage.setItem(LS_KEYS.logo, val);
      preLogo.textContent = val;
      alert('Logo preloader disimpan.');
    });
    if(savedLogo) logoInitial.value = savedLogo;

    // Save & restore typing words
    saveTypingBtn.addEventListener('click', ()=>{
      const val = typingWordsInp.value.trim();
      if(!val) return;
      localStorage.setItem(LS_KEYS.typing, val);
      words = val.split(',').map(s=>s.trim()).filter(Boolean);
      wi = 0; ci = 0; erasing = false;
      alert('Headline disimpan.');
    });
    typingWordsInp.value = (localStorage.getItem(LS_KEYS.typing) || 'Web Developer,Desainer Konten,Siap Kolaborasi,Belajar Tanpa Henti');

    // Reset all
    resetAllBtn.addEventListener('click', ()=>{
      if(confirm('Reset semua data (tema, nama, edit teks, galeri)?')){
        Object.values(LS_KEYS).forEach(k=>localStorage.removeItem(k));
        location.reload();
      }
    });

    // ===== GALLERY =====
    const fileInput = document.getElementById('fileInput');
    const btnUpload = document.getElementById('btnUpload');
    const dropzone = document.getElementById('dropzone');
    const grid = document.getElementById('galleryGrid');

    btnUpload.addEventListener('click', ()=>{
      if(!isAdmin){ alert('Hanya admin yang bisa upload. Klik ikon gembok (ðŸ”’) dan masuk sebagai admin.'); return; }
      fileInput.click();
    });
    fileInput.addEventListener('change', handleFiles);

    ;['dragenter','dragover'].forEach(evt => dropzone.addEventListener(evt, e=>{
      e.preventDefault(); e.stopPropagation(); dropzone.classList.add('hover');
    }));
    ;['dragleave','drop'].forEach(evt => dropzone.addEventListener(evt, e=>{
      e.preventDefault(); e.stopPropagation(); dropzone.classList.remove('hover');
    }));
    dropzone.addEventListener('drop', e=>{
      if(!isAdmin){ alert('Hanya admin yang bisa upload.'); return; }
      const files = e.dataTransfer.files;
      handleFiles({target:{files}});
    });

    function handleFiles(e){
      const files = [...e.target.files];
      if(!files.length) return;
      files.forEach(file=>{
        if(!file.type.startsWith('image/')) return;
        const reader = new FileReader();
        reader.onload = ()=>{ addToGallery(reader.result); };
        reader.readAsDataURL(file);
      });
      fileInput.value = '';
    }

    function loadGallery(){
      const data = JSON.parse(localStorage.getItem(LS_KEYS.gallery) || '[]');
      grid.innerHTML = '';
      data.forEach(item=> renderItem(item));
    }

    function saveGallery(arr){
      localStorage.setItem(LS_KEYS.gallery, JSON.stringify(arr));
    }

    function addToGallery(dataURL){
      const arr = JSON.parse(localStorage.getItem(LS_KEYS.gallery) || '[]');
      const id = 'g'+Date.now()+Math.random().toString(36).slice(2,7);
      const item = { id, url: dataURL, caption: '' };
      arr.unshift(item);
      saveGallery(arr);
      renderItem(item, true);
    }

    function renderItem(item, prepend=false){
      const card = document.createElement('div');
      card.className = 'g-item';
      card.innerHTML = `
        <figure>
          <img src="${item.url}" alt="Foto galeri">
          <figcaption ${isAdmin ? 'contenteditable="true"' : ''}>${item.caption||''}</figcaption>
        </figure>
        <div class="g-actions ${isAdmin ? 'show':''}">
          <button class="chip danger">Hapus</button>
        </div>
      `;
      const delBtn = card.querySelector('.chip.danger');
      delBtn.addEventListener('click', ()=>{
        if(!confirm('Hapus foto ini?')) return;
        const arr = JSON.parse(localStorage.getItem(LS_KEYS.gallery) || '[]');
        const ix = arr.findIndex(x=>x.id===item.id);
        if(ix>-1){ arr.splice(ix,1); saveGallery(arr); }
        card.remove();
      });
      const captionEl = card.querySelector('figcaption');
      captionEl.addEventListener('blur', ()=>{
        const arr = JSON.parse(localStorage.getItem(LS_KEYS.gallery) || '[]');
        const it = arr.find(x=>x.id===item.id);
        if(it){ it.caption = captionEl.textContent.trim(); saveGallery(arr); }
      });
      if(prepend) grid.prepend(card); else grid.appendChild(card);
    }

    function updateGalleryAdminState(){
      grid.querySelectorAll('.g-item figcaption').forEach(c=>{
        if(isAdmin) c.setAttribute('contenteditable','true'); else c.removeAttribute('contenteditable');
      });
      grid.querySelectorAll('.g-item .g-actions').forEach(a=>{
        a.classList.toggle('show', isAdmin);
      });
    }

    loadGallery();

    // ===== Admin listeners reflected to gallery =====
    const adminBtnObserver = new MutationObserver(updateGalleryAdminState);
    adminBtnObserver.observe(document.body, { attributes:true, attributeFilter:['class'] });
  </script>
</body>
</html>